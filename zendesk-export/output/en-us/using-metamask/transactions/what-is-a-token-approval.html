<h3>Contents</h3>
<ul>
<li><a href="#h_01G6WZRAE8A9Z3G3J07M14J923" target="_self">What is a token approval?</a></li>
<li><a href="#h_01G6WZRG3D3HY3J4W1DR9238KF" target="_self">What they look like</a></li>
<li><a href="#h_01G6WZRNT2BS61XJHV0S9CXD2P" target="_self">What they mean</a></li>
<li><a href="#h_01G6WZRV65M72W3J1518B5T6ZC" target="_self">Revoking approvals</a></li>
<li><a href="#h_01G6X0J818RMX8E35CCPE0KQEH" target="_self">Unlimited token approvals</a></li>
<li>
<a href="#h_01GA1DZF6GH7EAJV86X6D839H6" target="_self">setApprovalForAll</a> </li>
<li><a href="#h_01GA1DZN3YZQX2MCZ7A3H45ZSW" target="_self">Additional resources</a></li>
</ul>
<p> </p>
<p>Across web3, you'll encounter a range of transaction types, each of which is identifiable in MetaMask at the point of confirming the transaction. </p>
<p>Understanding what they are and how to interpret their meaning is an important part of staying safe in web3. The challenge is that much of the information displayed on these screens is either not designed to be human-readable—such as the long hexadecimal numbers we recognize as account or contract addresses—or, at best, is difficult to decipher.</p>
<p><strong>Token approvals </strong>are among the most common of the transaction types you'll encounter, and learning about them is therefore essential. In web3, and especially with a<a href="https://support.metamask.io/hc/en-us/articles/360059952212" target="_self"> self-custodial</a> wallet like MetaMask, you're firmly in control and hold ultimate responsibility for everything you do. That's why it's critical you know exactly what you're signing up for when you confirm token approvals.</p>
<h2 id="h_01G6WZRAE8A9Z3G3J07M14J923">What is a token approval?</h2>
<p>In short: <strong>permission for a dapp to access and move a specific type of token from your wallet</strong>. </p>
<p>These prompts will often appear in MetaMask if you're a frequent user of decentralized exchanges (DEXs) and DeFi in general. Most platforms rely on you depositing or transferring your tokens to them for one reason or another. However, clicking buttons such as 'Transfer', 'Deposit', or 'Move' won't do anything unless their dapp has your permission—as the wallet owner—to do so.</p>
<p>This is why token approvals are necessary: they enable the dapp to access and move your tokens on your behalf. </p>
<h2 id="h_01G6WZRG3D3HY3J4W1DR9238KF">What they look like</h2>
<p>The token approval prompt that appears in MetaMask will look something like this:</p>
<p class="wysiwyg-text-align-center"><img src="https://support.metamask.io/hc/article_attachments/13644257662235" alt="Custom spending cap extension" width="315" height="542"></p>
<p class="wysiwyg-text-align-center"> </p>
<p class="wysiwyg-text-align-left">Let's dissect this. Notice how:</p>
<ul>
<li class="wysiwyg-text-align-left">
<strong>The dapp's name and web URL are displayed at the top.</strong> This helps you make sure that the dapp you <em>expect to be</em> interacting with is actually the one requesting the approval. </li>
<li class="wysiwyg-text-align-left">You <strong>can click 'verify contract details' to see the address of the smart contract requesting access</strong>. If you're interacting with a dapp/contract you're not 100% sure about, you could take this address and look it up on a block explorer such as <a href="https://etherscan.io/" target="_self">Etherscan</a> to look for any strange activity, or to see if it is flagged as a potential scam.</li>
<li class="wysiwyg-text-align-left">
<strong>You can</strong> <strong>edit the permission under the 'custom spending cap' field</strong>. In this context, the cap refers to how much of that token (in this case, USDC) the dapp can access. Note that this is not limited by how much of the token you actually have in your account; <a href="#h_01G6X0J818RMX8E35CCPE0KQEH" target="_self">it can and often does drastically exceed this</a>. For more on editing token approvals, see our <a href="https://support.metamask.io/hc/en-us/articles/6055177143579" target="_self" rel="undefined">article on setting a custom spending cap</a>.</li>
<li class="wysiwyg-text-align-left">
<strong>You have to pay gas fees</strong>. The only way for the approval to be secure is for everyone to be 100% sure it came from you, the wallet owner. Thankfully, we just so happen to be using a decentralized, immutable ledger (i.e. blockchain) that can record your permission as historical fact. But for this permission to be recorded, it must be on chain; and for any transaction to be processed on chain, you must pay the costs of operating the network: gas. </li>
</ul>
<h2 id="h_01G6WZRNT2BS61XJHV0S9CXD2P">What they mean</h2>
<p>If you grant permission for a dapp to access 1,000 USDT, it can do so whenever you ask it to, without requiring a similar token approval transaction again. This applies until the dapp has had access to 1,000 tokens, at which point you'll need to sign another transaction. </p>
<p>But what's going on behind the scenes? Well, when you approve access to a token, in many cases you're consenting to the dapp calling the <a href="https://docs.openzeppelin.com/contracts/2.x/api/token/erc20#IERC20-Transfer-address-address-uint256-:~:text=an%20Approval%20event.-,transferFrom(address%20sender%2C%20address%20recipient%2C%20uint256%20amount)%20%E2%86%92%20bool,-external" target="_self">transferFrom</a> function, one of the functions defined in the ERC-20 standard. (In programming, to 'call' a function is to use it.) It enables the dapp to transfer a given amount of the token from your wallet into theirs. The amount is determined by a corresponding <a href="https://docs.openzeppelin.com/contracts/2.x/api/token/erc20#IERC20-Approval-address-address-uint256-:~:text=transferFrom%20are%20called.-,approve(address%20spender%2C%20uint256%20amount)%20%E2%86%92%20bool,-external" target="_self">approve</a> function, for which—you guessed it—you provide inputs for when you sign your token <em>approval</em>.</p>
<p>You can see this process in action when you're presented with the approval confirmation in MetaMask. If you scroll down to 'View full transaction details' and click it, you can see the 'Approve' function listed:</p>
<p class="wysiwyg-text-align-center"><img src="https://support.metamask.io/hc/article_attachments/13644467046811" alt="Token approval data" width="315" height="352"> </p>
<p class="wysiwyg-text-align-center"> </p>
<p class="wysiwyg-text-align-left">The 'Granted to' field gives you another opportunity to copy the contract address that's asking for approval and verify its legitimacy on a block explorer. </p>
<div class="callout callout--info">
<h4 class="callout__title">EIP-3009: the <em>permit</em> function and minimizing gas fees</h4>
<p>Not every token you come across works as we've described above, which relates to ERC-20 tokens. This mechanism of <em>approve</em> + <em>transferFrom</em> is not relevant for tokens that have implemented the <a href="https://eips.ethereum.org/EIPS/eip-3009" target="_self">EIP-3009</a> model, with the stablecoin USDC the most prominent example.</p>
<p>With EIP-3009, rather than an <em>approve </em>transaction, you sign a <em>permit </em>transaction. These bundle up the approval and transfer into one transaction, meaning that you effectively pay zero gas for the approval, and just pay the gas for transferring the tokens.</p>
</div>
<p class="wysiwyg-text-align-left">Want more information on approvals? See our <a href="https://consensys.net/blog/metamask/the-seal-of-approval-know-what-youre-consenting-to-with-permissions-and-approvals-in-metamask/" target="_self">blog post</a> on the subject for a deep dive. </p>
<h2 id="h_01G6WZRV65M72W3J1518B5T6ZC" class="wysiwyg-text-align-left">Revoking token approvals</h2>
<p>It never hurts to be in control of your assets, and to be aware of which dapps have access to them. There are a few ways to revoke existing token approvals: see our <a href="https://support.metamask.io/hc/en-us/articles/4446106184731" target="_self">article</a> for more detail. </p>
<h2 id="h_01G6X0J818RMX8E35CCPE0KQEH">Unlimited token approvals: how to stay safe</h2>
<p>Often, token approval requests will ask for access to so many tokens that it's essentially unlimited — just see the screenshot above, which shows Uniswap requesting access to 1.15<sup>59</sup> tokens. Many legitimate dapps do this to minimize the need—and associated transaction costs—for you to re-approve access to the token every time you want to use it on a dapp. Think of DEXs, for example: if you're conducting a lot of token swaps, you don't want the additional clicks and gas fees every single time. </p>
<p>However, requesting essentially unlimited amounts of tokens is also how many malicious sites steal from unsuspecting web3 users. This can be particularly demoralizing as a user if you've adhered to all our recommended <a href="https://support.metamask.io/hc/en-us/articles/360015489591" target="_self">security tips</a>, including keeping your Secret Recovery Phrase offline-only, and never sharing it: despite all your efforts, you could be exploited anyway. </p>
<p>To make sure you're not granting bad actors access to all of your tokens, we recommend you follow these key principles (which we've borrowed from our <a href="https://consensys.net/blog/metamask/fake-mining-scams-a-familiar-foe-in-a-new-disguise/" target="_self">blog post</a>):</p>
<ul>
<li>
<strong>Always check what a dapp is actually requesting before clicking ‘approve’</strong>. In MetaMask, you can also <a href="https://twitter.com/MetaMask/status/1245769574131400709" target="_blank" rel="noopener noreferrer">adjust the amount</a> that the dapp has access to. Even if you only provide access to 10% of your tokens, and the dapp turns out to be a scam, that’s still a considerably better outcome than if you’d granted unlimited access.</li>
<li>DYOR. The best time to get in the habit of performing <strong>due diligence</strong> on any dapp before interacting with it was six months ago; the second best time is today. Look out for misspellings, low-quality images/logos, and other giveaways. </li>
<li>Remember that <strong>if something seems too good to be true, it probably is</strong>. If you’re being offered 498,563% APY, you’re probably on thin ice. </li>
</ul>
<h2 id="h_01GA1DZF6GH7EAJV86X6D839H6">
<em>setApprovalForAll</em>: Making it easier to know what you're approving in MetaMask</h2>
<p>If you're not familiar with Ethereum smart contract code, <em>setApprovalForAll</em> may look mildly bewildering, but it's worth knowing about if you interact with dapps. </p>
<p>This is a function in the <a href="https://docs.openzeppelin.com/contracts/2.x/api/token/erc721#IERC721-setApprovalForAll-address-bool-:~:text=setApprovalForAll(address%20operator%2C%20bool%20_approved)" target="_self">ERC-721 and ERC-1155 standards</a> (which relate specifically to NFTs) that enables you to grant or revoke other addresses the ability to manage <strong>all of your NFTs associated with a specific smart contract</strong>. </p>
<p>One of the most common applications for this function is NFT marketplaces. When you sell an NFT on a platform such as OpenSea, you need to allow the dapp to access and transfer that NFT to the buyer when it sells. Such platforms often request access to <em>all </em>the NFTs of that type (i.e. originating from the same smart contract). For you, the user, this is generally inconsequential — we trust large platforms such as OpenSea not to overstep the boundary and remove NFTs that they shouldn't. </p>
<p>And, like we said, <em>generally </em>it ends there. However—like many areas of web3—this is a potential opening for scammers; either by exploiting an existing dapp to which many wallets have already granted access to <em>all </em>tokens of a certain type, or by luring you into granting approval to a malicious dapp. </p>
<p>This is why <strong>MetaMask Extension makes it as clear as possible what you're consenting to when you sign a <em>setApprovalForAll </em>transaction</strong>. This is how it'll look:</p>
<p class="wysiwyg-text-align-center"><img src="https://support.metamask.io/hc/article_attachments/14627842608795" alt="ApproveAll Notifcation" width="315" height="542"></p>
<p class="wysiwyg-text-align-center"> </p>
<p class="wysiwyg-text-align-left">Notice also how you have the option to '<strong>Verify contract details</strong>'. If you click this, you'll be able to access a page showing the name, if any, of:</p>
<ul>
<li class="wysiwyg-text-align-left">The contract requesting access</li>
<li class="wysiwyg-text-align-left">The NFT contract. </li>
</ul>
<p class="wysiwyg-text-align-left">MetaMask retrieves this information from publicly available data, and you can also copy each contract's address to your clipboard if you want to investigate further. See our <a href="https://support.metamask.io/hc/en-us/articles/10143114273563" target="_self">article on verifying the safety of smart contracts</a> for what kinds of things to look out for at this point. </p>
<p class="wysiwyg-text-align-left">Given that this function allows access to all tokens associated with the contract, two things should cross your mind when you're presented with it:</p>
<ul>
<li class="wysiwyg-text-align-left">Does the dapp I'm interacting with actually need access to all of my tokens? </li>
<li class="wysiwyg-text-align-left">Is this a legitimate, non-malicious site that isn't trying to scam me? </li>
</ul>
<p>One common <em>non-</em>legitimate application of this function is when malicious dapps ask you to <em>setApprovalForAll </em>to claim an NFT drop: <strong>you shouldn't have to sign this kind of approval to receive anything</strong>. Don't be fooled!</p>
<p class="wysiwyg-text-align-left">We can't protect you from the risks inherent in using web3: as the owner of a <a href="https://support.metamask.io/hc/en-us/articles/360059952212" target="_self">self-custodial wallet</a>, that responsibility lies with you. However, with changes such as this, we're working to equip you with the information you need to stay vigilant and aware of exactly what you're doing. </p>
<h2 id="h_01GA1DZN3YZQX2MCZ7A3H45ZSW">Further reading</h2>
<p>For more reading on token approvals, and the unlimited approvals <em>gotcha </em>specifically, see here:</p>
<ul>
<li><a href="https://consensys.net/blog/metamask/fake-mining-scams-a-familiar-foe-in-a-new-disguise/" target="_self">Fake “Mining” Scams: a Familiar Foe in a New Disguise</a></li>
<li><a href="https://consensys.net/blog/metamask/the-seal-of-approval-know-what-youre-consenting-to-with-permissions-and-approvals-in-metamask/">The Seal of Approval: Know What You’re Consenting To With Permissions and Approvals in MetaMask</a></li>
<li><a href="https://support.metamask.io/hc/en-us/articles/4446106184731-How-to-revoke-smart-contract-allowances-token-approvals">How to revoke smart contract allowances/token approvals</a></li>
<li><a href="https://support.metamask.io/hc/en-us/articles/6055177143579-How-to-customize-token-approvals-allowances-with-custom-spend-limit">How to customize token approvals/allowances with custom spend limit</a></li>
</ul>